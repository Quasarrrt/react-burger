(this["webpackJsonpreact-burger"]=this["webpackJsonpreact-burger"]||[]).push([[0],{106:function(e,t,r){e.exports={navigation:"Navigation_navigation__DvYFG"}},107:function(e,t,r){e.exports={profileLink:"ProfileHeader_profileLink__AF3AC"}},109:function(e,t,r){e.exports={itemWrapper:"BurgerConstructorItem_itemWrapper__3glNO"}},110:function(e,t,r){e.exports={overlay:"ModalOverlay_overlay__3Zmwc"}},111:function(e,t,r){e.exports={main:"App_main__3oxZb"}},112:function(e,t,r){e.exports={price:"Price_price__1_4aS"}},113:function(e,t,r){e.exports={orderInfo:"order-info_orderInfo__18y6E"}},115:function(e,t,r){e.exports={orders:"Orders_orders__3hW8F"}},116:function(e,t,r){},117:function(e,t,r){e.exports={orderInfo:"profile-order_orderInfo__20j8u"}},125:function(e,t,r){},16:function(e,t,r){e.exports={ingredientContainer:"IngredientDetails_ingredientContainer__3B6Yy",image:"IngredientDetails_image__2WgZ6",title:"IngredientDetails_title__2aCO9",list:"IngredientDetails_list__2cDET",calories:"IngredientDetails_calories___686P",caloriesNum:"IngredientDetails_caloriesNum__yAzOL"}},18:function(e,t,r){e.exports={orderInfo:"OrderInfo_orderInfo__3GSEn",orderNumber:"OrderInfo_orderNumber__2f2_F",orderStatus:"OrderInfo_orderStatus__29loK",descriptionList:"OrderInfo_descriptionList__3xU27",descriptionDefinition:"OrderInfo_descriptionDefinition__3raQf",list:"OrderInfo_list__1-qNf",figure:"OrderInfo_figure__3FmMb",img:"OrderInfo_img__2jSXY",figcaption:"OrderInfo_figcaption__1cMmY",ingredientName:"OrderInfo_ingredientName__1aWgw",info:"OrderInfo_info__1f4y3"}},19:function(e,t,r){e.exports={orderFeed:"feed_orderFeed__13Zr-",container:"feed_container__3OKf6",stats:"feed_stats__1GNQx",readyWithInProgressContainer:"feed_readyWithInProgressContainer__edeRX",numberOfOrders:"feed_numberOfOrders__6rFwG",list:"feed_list__340Mo",ordersContainer:"feed_ordersContainer__23GU7"}},203:function(e,t,r){"use strict";r.r(t);var n=r(1),a=r.n(n),c=r(33),s=r.n(c),o=(r(125),r(5)),i=r(6),u=r(4),l=r(60),d=r.n(l),j=r(0),p=function(e){var t=e.icon,r=e.text,n=e.path;return Object(j.jsxs)("span",{className:"".concat(d.a.link," text_color_inactive pl-5 pr-5 pt-4 pb-4 mt-4 mb-4"),children:[Object(j.jsx)(t,{type:"secondary"}),Object(j.jsx)(i.c,{className:"".concat(d.a.linkText," text text_type_main-default text_color_inactive ml-2"),activeClassName:d.a.linkTextActive,to:n,exact:!0,children:r})]})},f=r(106),O=r.n(f);var m=function(){return Object(j.jsxs)("nav",{className:O.a.navigation,children:[Object(j.jsx)(p,{icon:u.BurgerIcon,text:"\u041a\u043e\u043d\u0441\u0442\u0440\u0443\u043a\u0442\u043e\u0440",path:"/"}),Object(j.jsx)(p,{icon:u.ListIcon,text:"\u041b\u0435\u043d\u0442\u0430 \u0437\u0430\u043a\u0430\u0437\u043e\u0432",path:"/feed"})]})},b=r(107),_=r.n(b);var h=function(){return Object(j.jsx)("div",{className:_.a.profileLink,children:Object(j.jsx)(p,{icon:u.ProfileIcon,text:"\u041b\u0438\u0447\u043d\u044b\u0439 \u043a\u0430\u0431\u0438\u043d\u0435\u0442",path:"/profile"})})},x=r(83),g=r.n(x);var v=function(){return Object(j.jsx)("header",{className:g.a.header,children:Object(j.jsxs)("div",{className:g.a.headerContainer,children:[Object(j.jsx)(m,{}),Object(j.jsx)(i.b,{to:"/",children:Object(j.jsx)(u.Logo,{})}),Object(j.jsx)(h,{})]})})},y=r(34),N=r.n(y),S=r(30),E=r.n(S),C=r(29),I=function(){return Object(C.b)()},T=C.c,k="ADD_VIEWED_INGREDIENT_DATA",R="REMOVE_VIEWED_INGREDIENT_DATA",D=r(210),w=r(9),U=function(e){var t=e.card,r=e.onCardClick,n=I(),a=T((function(e){return e.constructorIngredients})),c=a.constructorIngredients,s=a.isBun,l=Object(D.a)({type:"item",item:t,collect:function(e){return{isDrag:e.isDragging()}}}),d=Object(o.a)(l,2)[1];var p="bun"===t.type&&(null===s||void 0===s?void 0:s._id)===t._id?2:"bun"!==t.type?c.filter((function(e){return e._id===t._id})).length:0,f=Object(w.h)(),O=t._id;return Object(j.jsxs)(i.b,{className:["mr-2 ml-4 mt-6 mb-10",E.a.card].join(" "),ref:d,to:{pathname:"/ingredients/".concat(O),state:{background:f}},onClick:function(){return n({type:k,payload:t}),r(t),!1},children:[Object(j.jsx)("div",{className:E.a.counter,children:Object(j.jsx)(u.Counter,{count:p,size:"default"})}),Object(j.jsx)("img",{src:t.image,alt:t.name,className:["pr-4 pl-4",E.a.pic].join(" ")}),Object(j.jsxs)("div",{className:["pt-1 pb-1",E.a.price].join(" "),children:[Object(j.jsx)("p",{className:["pr-2 text text_type_digits-default",E.a.priceNum].join(" "),children:t.price}),Object(j.jsx)(u.CurrencyIcon,{type:"primary"})]}),Object(j.jsx)("p",{className:["text text_type_main-default",E.a.name].join(" "),children:t.name})]})},A=r(61),P=function(e){var t=e.onCardClick,r=a.a.useState("one"),c=Object(o.a)(r,2),s=c[0],i=c[1],l=T((function(e){return e.allIngredients})).allIngredients,d=Object(A.a)({threshold:0}),p=Object(o.a)(d,2),f=p[0],O=p[1],m=Object(A.a)({threshold:0}),b=Object(o.a)(m,2),_=b[0],h=b[1],x=Object(A.a)({threshold:0}),g=Object(o.a)(x,2),v=g[0],y=g[1];Object(n.useEffect)((function(){O?i("one"):h?i("two"):y&&i("three")}),[O,h,y]);var S=function(e){i(e);var t=document.getElementById(e);t&&t.scrollIntoView({behavior:"smooth"})},E=l.filter((function(e){return"bun"===e.type})),C=l.filter((function(e){return"sauce"===e.type})),I=l.filter((function(e){return"main"===e.type}));return Object(j.jsxs)("section",{className:["mr-10",N.a.section].join(" "),children:[Object(j.jsx)("p",{className:"text text_type_main-large pb-5 pt-10",children:"\u0421\u043e\u0431\u0435\u0440\u0438\u0442\u0435 \u0431\u0443\u0440\u0433\u0435\u0440"}),Object(j.jsx)("nav",{children:Object(j.jsxs)("div",{style:{display:"flex"},className:"pb-10",children:[Object(j.jsx)(u.Tab,{value:"one",active:"one"===s,onClick:S,children:"\u0411\u0443\u043b\u043a\u0438"}),Object(j.jsx)(u.Tab,{value:"two",active:"two"===s,onClick:S,children:"\u0421\u043e\u0443\u0441\u044b"}),Object(j.jsx)(u.Tab,{value:"three",active:"three"===s,onClick:S,children:"\u041d\u0430\u0447\u0438\u043d\u043a\u0438"})]})}),Object(j.jsx)("div",{children:Object(j.jsxs)("div",{className:N.a.scroll,children:[Object(j.jsxs)("section",{ref:f,children:[Object(j.jsx)("p",{className:"text text_type_main-medium",children:"\u0411\u0443\u043b\u043a\u0438"}),Object(j.jsx)("div",{className:N.a.cards,children:E&&E.map((function(e){return Object(j.jsx)(U,{card:e,onCardClick:t},e._id)}))})]}),Object(j.jsxs)("section",{ref:_,children:[Object(j.jsx)("p",{className:"text text_type_main-medium",children:"\u0421\u043e\u0443\u0441\u044b"}),Object(j.jsx)("div",{className:N.a.cards,children:C.map((function(e){return Object(j.jsx)(U,{card:e,onCardClick:t},e._id)}))})]}),Object(j.jsxs)("section",{ref:v,children:[Object(j.jsx)("p",{className:"text text_type_main-medium",children:"\u041d\u0430\u0447\u0438\u043d\u043a\u0438"}),Object(j.jsx)("div",{className:N.a.cards,children:I.map((function(e){return Object(j.jsx)(U,{card:e,onCardClick:t},e._id)}))})]})]})})]})},W=r(44),q=r(62),B=r.n(q),G="ADD_CONSTRUCTOR_INGREDIENTS_BUN",L="ADD_CONSTRUCTOR_INGREDIENTS",F="DELETE_CONSTRUCTOR_INGREDIENTS",z="MOVE_CONSTRUCTOR_INGREDIENTS",M="RESET_CONSTRUCTOR",H=r(2),Q=r(57),J=r(58),V=r(45),K=r.n(V),X=r(85),Y="https://norma.nomoreparties.space/api",$=function(e){return e.ok?e.json():e.json().then((function(e){return Promise.reject(e)}))},Z=function(){var e=Object(X.a)(K.a.mark((function e(){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(Y,"/ingredients"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ee=function(){var e=Object(X.a)(K.a.mark((function e(t,r){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(Y,"/orders"),{method:"POST",headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/json"},body:JSON.stringify({ingredients:t})});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),te=new(function(){function e(t){var r=t.serverUrl,n=t.headers;Object(Q.a)(this,e),this._headers=void 0,this._serverUrl=void 0,this._headers=n,this._serverUrl=r}return Object(J.a)(e,[{key:"getOrdersData",value:function(){return fetch("".concat(this._serverUrl,"/orders/all"),{method:"GET",headers:this._headers}).then($)}},{key:"getUserOrdersData",value:function(e){return fetch("".concat(this._serverUrl,"/orders"),{method:"GET",headers:Object(H.a)(Object(H.a)({},this._headers),{},{Authorization:"Bearer ".concat(e)})}).then($)}}]),e}())({serverUrl:Y,headers:{Authorization:"",Accept:"application/json","Content-Type":"application/json"}}),re="GET_ORDER_REQUEST",ne="GET_ORDER_SUCCESS",ae="SET_ORDER_ERROR",ce=r(35),se=r.n(ce),oe=r(211),ie=r(109),ue=r.n(ie),le=r(212),de=function(e){var t=e.type,r=e.burger,a=e.index,c=e.locked,s=I();var i=Object(n.useRef)(null),l=Object(oe.a)({accept:"ingredients",collect:function(e){return{handlerId:e.getHandlerId()}},hover:function(e,t){if(i.current){var r=e.index,n=a;if(r&&r!==n){var c=i.current.getBoundingClientRect(),o=(c.bottom-c.top)/2,u=t.getClientOffset();if(u){var l=u.y-c.top;r<n&&l<o||r>n&&l>o||(s({type:z,payload:{dragIndex:r,hoverIndex:n}}),e.index=n)}}}}}),d=Object(o.a)(l,2),p=d[0].handlerId,f=d[1],O=Object(D.a)({type:"ingredients",item:function(){return{burger:r,index:a}},collect:function(e){return{isDragging:e.isDragging()}}});return(0,Object(o.a)(O,2)[1])(f(i)),Object(j.jsxs)("div",{ref:i,"data-handler-id":p,className:["mb-4",ue.a.itemWrapper].join(" "),children:["bun"!==r.type?Object(j.jsx)(u.DragIcon,{type:"primary"}):null,Object(j.jsx)(u.ConstructorElement,{text:"bun"!==r.type?null===r||void 0===r?void 0:r.name:"top"===t?(null===r||void 0===r?void 0:r.name)+" (\u0432\u0435\u0440\u0445)":(null===r||void 0===r?void 0:r.name)+" (\u043d\u0438\u0437)",price:null===r||void 0===r?void 0:r.price,thumbnail:null===r||void 0===r?void 0:r.image,type:t,isLocked:c,handleClose:function(){s({type:F,ingredientItemIndex:a})}})]})};var je=function(){var e=T((function(e){return e.constructorIngredients})),t=e.constructorIngredients,r=e.isBun,n=I(),a=Object(oe.a)({accept:"item",drop:function(e){!function(e){"bun"===e.type?n({type:G,ingredientItem:e}):n(function(e){return{type:L,ingredientItem:Object(H.a)(Object(H.a)({},e),{},{key:Object(le.a)()})}}(e))}(e)}}),c=Object(o.a)(a,2)[1];return Object(j.jsx)("section",{ref:c,children:Object(j.jsxs)("ul",{className:se.a.ul,children:[Object(j.jsx)("li",{className:se.a.item,children:r&&Object(j.jsx)(de,{type:"top",burger:r,locked:!0,index:0})}),Object(j.jsx)("div",{className:se.a.scroll,children:t&&t.filter((function(e){return"bun"!==e.type})).map((function(e,t){return Object(j.jsx)(de,{burger:e,index:t},e.key)}))}),Object(j.jsx)("li",{className:["pt-4",se.a.item].join(" "),children:Object(j.jsx)("div",{className:se.a.itemWrapper,children:r&&Object(j.jsx)(de,{type:"bottom",burger:r,locked:!0,index:0})})})]})})},pe=r(36),fe=r.n(pe),Oe=r.p+"static/media/done.85c3a14d.svg",me=function(){var e=T((function(e){return e.order.orderNumber}));return Object(j.jsxs)("div",{className:fe.a.orderWrapper,children:[Object(j.jsx)("div",{className:["mt-4 mb-8 text text_type_digits-large",fe.a.orderNum].join("  "),children:e}),Object(j.jsx)("p",{className:["mb-15 text text_type_main-medium",fe.a.order].join("  "),children:"\u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440 \u0437\u0430\u043a\u0430\u0437\u0430"}),Object(j.jsx)("img",{src:Oe,alt:"\u0413\u043e\u0442\u043e\u0432\u043e",className:"mb-15"}),Object(j.jsx)("p",{className:["mb-2 text text_type_main-default",fe.a.order].join("  "),children:"\u0412\u0430\u0448 \u0437\u0430\u043a\u0430\u0437 \u043d\u0430\u0447\u0430\u043b\u0438 \u0433\u043e\u0442\u043e\u0432\u0438\u0442\u044c"}),Object(j.jsx)("p",{className:["mb-30 text text_type_main-default text_color_inactive",fe.a.order].join("  "),children:"\u0414\u043e\u0436\u0434\u0438\u0442\u0435\u0441\u044c \u0433\u043e\u0442\u043e\u0432\u043d\u043e\u0441\u0442\u0438 \u043d\u0430 \u043e\u0440\u0431\u0438\u0442\u0430\u043b\u044c\u043d\u043e\u0439 \u0441\u0442\u0430\u043d\u0446\u0438\u0438"})]})},be=r(46),_e=r.n(be),he=r(110),xe=r.n(he),ge=function(e){var t=e.onClose;return Object(j.jsx)("div",{className:xe.a.overlay,onClick:t})},ve=function(e){var t=e.open,r=e.children,a=e.onClose,c=e.title,o=e.isGoBack,i=function(e){"Escape"===e.key&&a(o)};if(Object(n.useEffect)((function(){return document.addEventListener("keydown",i),function(){return document.removeEventListener("keydown",i)}})),!t)return null;var l=function(){a(o)};return s.a.createPortal(Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(ge,{onClose:l}),Object(j.jsxs)("div",{className:["pr-10 pl-10 pt-10",_e.a.modalHeader].join(" "),children:[Object(j.jsxs)("div",{className:_e.a.modalHeaderWrapper,children:[Object(j.jsx)("h2",{className:["text text_type_main-large",_e.a.headerText].join(" "),children:c}),Object(j.jsx)("button",{onClick:l,className:_e.a.button,children:Object(j.jsx)(u.CloseIcon,{type:"primary"})})]}),r]})]}),document.getElementById("portal"))};function ye(e){var t=e.accessToken.split("Bearer ")[1],r=e.refreshToken;document.cookie="accessToken=".concat(t),document.cookie="refreshToken=".concat(r)}function Ne(){return document.cookie.replace(/(?:(?:^|.*;\s*)refreshToken\s*=\s*([^;]*).*$)|^.*$/,"$1")}function Se(){return document.cookie.replace(/(?:(?:^|.*;\s*)accessToken\s*=\s*([^;]*).*$)|^.*$/,"$1")}var Ee=function(e){var t=e.history,r=T((function(e){return e.auth})).loginSuccess,a=Ne(),c=I(),s=T((function(e){return e.constructorIngredients})),i=s.constructorIngredients,l=s.isBun,d=Object(n.useState)(!1),p=Object(o.a)(d,2),f=p[0],O=p[1],m=Object(j.jsx)(ve,{open:f,onClose:function(){O(!1)},title:"",isGoBack:!0,children:Object(j.jsx)(me,{})}),b=function(){var e=localStorage.getItem("token");if(r||a)if(null!==l){if(l._id){var n=[].concat(Object(W.a)(i.map((function(e){return e._id}))),[l._id]);O(!0),c(function(e,t){return function(r){r({type:re}),ee(e,t).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430 ".concat(e.status))})).then((function(e){e&&e.success?r({type:ne,orderNumber:e.order.number}):r({type:ae})})).catch((function(e){r({type:ae})}))}}(n,e)),c({type:M})}}else c({type:ae});else t.push("/login")},_=Object(n.useMemo)((function(){return i.reduce((function(e,t){var r=t.price;return"bun"===t.type&&(r+=t.price),e+r}),0)+(l?2*l.price:0)}),[i,l]);return Object(j.jsx)(j.Fragment,{children:Object(j.jsxs)("section",{className:["pt-25 pl-4 pr-4",B.a.items].join(" "),children:[Object(j.jsx)(je,{}),Object(j.jsxs)("div",{className:["pt-10",B.a.totalWrapper].join(" "),children:[Object(j.jsxs)("div",{className:["pr-10",B.a.totalPrice].join(" "),children:[Object(j.jsx)("p",{className:"text text_type_digits-medium",children:_||0}),Object(j.jsx)(u.CurrencyIcon,{type:"primary"})]}),Object(j.jsx)(u.Button,{type:"primary",size:"large",onClick:function(){b()},children:"\u041e\u0444\u043e\u0440\u043c\u0438\u0442\u044c \u0437\u0430\u043a\u0430\u0437"}),f&&m]})]})})},Ce=r(111),Ie=r.n(Ce),Te=r(16),ke=r.n(Te),Re=function(){var e=Object(w.i)().id,t=I(),r=T((function(e){return e.allIngredients})).allIngredients;Object(n.useEffect)((function(){var n=r.find((function(t){return t._id===e}));n&&t({type:k,payload:n})}),[e,r,t]);var a=T((function(e){return e.viewedIngredient})).currentIngredient;return Object(j.jsxs)("div",{className:ke.a.ingredientContainer,children:[Object(j.jsx)("img",{src:a.image,alt:a.name,className:["mb-4",ke.a.image].join(" ")}),Object(j.jsx)("h3",{className:["text text_type_main-medium mb-8",ke.a.title].join(" "),children:a.name}),Object(j.jsxs)("ul",{className:["mb-15",ke.a.list].join(" "),children:[Object(j.jsxs)("li",{className:["mr-5",ke.a.calories].join(" "),children:[Object(j.jsx)("p",{className:"text text_type_main-default",children:"\u041a\u0430\u043b\u043e\u0440\u0438\u0438,\u043a\u043a\u0430\u043b"}),Object(j.jsx)("p",{className:["mt-2 text text_type_digits-default",ke.a.caloriesNum].join(" "),children:a.calories})]}),Object(j.jsxs)("li",{className:["mr-5 text text_type_digits-default",ke.a.calories].join(" "),children:[Object(j.jsx)("p",{className:"text text_type_main-default",children:"\u0411\u0435\u043b\u043a\u0438, \u0433"}),Object(j.jsx)("p",{className:["mt-2 text text_type_digits-default",ke.a.caloriesNum].join(" "),children:a.proteins})]}),Object(j.jsxs)("li",{className:["mr-5",ke.a.calories].join(" "),children:[Object(j.jsx)("p",{className:"text text_type_main-default",children:"\u0416\u0438\u0440\u044b, \u0433"}),Object(j.jsx)("p",{className:["mt-2 text text_type_digits-default",ke.a.caloriesNum].join(" "),children:a.fat})]}),Object(j.jsxs)("li",{className:ke.a.calories,children:[Object(j.jsx)("p",{className:"text text_type_main-default",children:"\u0423\u0433\u043b\u0435\u0432\u043e\u0434\u044b, \u0433"}),Object(j.jsx)("p",{className:["mt-2 text text_type_digits-default",ke.a.caloriesNum].join(" "),children:a.carbohydrates})]})]})]})},De="GET_ORDERS_DATA_REQUEST",we="GET_ORDERS_DATA_SUCCESS",Ue="GET_ORDERS_DATA_ERROR",Ae=r(18),Pe=r.n(Ae),We=r(112),qe=r.n(We),Be=function(e){var t=e.textType,r=e.price,n=e.typeIcon;return Object(j.jsxs)("div",{className:"".concat(qe.a.price," mt-1 mb-1"),children:[Object(j.jsx)("p",{className:"text ".concat(t," pr-2"),children:r}),Object(j.jsx)(u.CurrencyIcon,{type:n})]})},Ge=function(e){var t=e.ordersData,r=e.orderDetailsData,n=e.id,a=T((function(e){return e.allIngredients})).allIngredients,c=t?t.orders.filter((function(e){return e._id===n}))[0]:r,s=function(e){var t=Date.parse(e);return new Date(t).toLocaleString()}(c?c.createdAt:""),o=0;return Object(j.jsxs)("section",{className:Pe.a.orderInfo,children:[Object(j.jsx)("p",{className:"".concat(Pe.a.orderNumber," text text_type_digits-default"),children:"#".concat(c?c.number:"")}),Object(j.jsx)("h2",{className:"text text_type_main-medium mt-10",children:c?c.name:""}),Object(j.jsx)("p",{className:"".concat(Pe.a.orderStatus," text text_type_main-default text_color_success mt-3"),children:c?function(e){switch(e.status){case"done":return"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d";case"pending":return"\u0413\u043e\u0442\u043e\u0432\u0438\u0442\u0441\u044f";case"cancelled":return"\u041e\u0442\u043c\u0435\u043d\u0435\u043d"}}(c):""}),Object(j.jsxs)("dl",{className:"".concat(Pe.a.descriptionList," mt-15"),children:[Object(j.jsx)("dt",{className:"text text_type_main-medium",children:"\u0421\u043e\u0441\u0442\u0430\u0432:"}),Object(j.jsx)("dd",{className:Pe.a.descriptionDefinition,children:Object(j.jsx)("ul",{className:"".concat(Pe.a.list," mt-6"),children:c&&c.ingredients.map((function(e,t){var r=a.find((function(t){return e===t._id}));return r&&(o+=+r.price),Object(j.jsx)("li",{children:Object(j.jsxs)("figure",{className:"".concat(Pe.a.figure," pr-6"),children:[Object(j.jsx)("img",{className:Pe.a.img,src:r?r.image:"",alt:r?r.name:""}),Object(j.jsxs)("figcaption",{className:"".concat(Pe.a.figcaption," ml-4"),children:[Object(j.jsx)("h3",{className:"".concat(Pe.a.ingredientName," text text_type_main-default mt-4"),children:r?r.name:""}),Object(j.jsx)(Be,{price:r?r.price:0,textType:"text_type_digits-default",typeIcon:"primary"})]})]})},"".concat(e," + ").concat(t))}))})})]}),Object(j.jsxs)("div",{className:"".concat(Pe.a.info," mt-10 mb-10"),children:[Object(j.jsx)("p",{className:"text text_type_main-default text_color_inactive",children:c?s:""}),Object(j.jsx)(Be,{price:o,textType:"text_type_digits-default",typeIcon:"primary"})]})]})},Le=r(113),Fe=r.n(Le),ze=function(){var e=Object(w.i)().id,t=I();a.a.useEffect((function(){t((function(e){return e({type:De}),te.getOrdersData().then((function(t){e({type:we,ordersData:t})})).catch((function(t){console.log(t),e({type:Ue})}))}))}),[t]);var r=T((function(e){return e.ordersData})).ordersData;return Object(j.jsx)("div",{className:Fe.a.orderInfo,children:Object(j.jsx)(Ge,{ordersData:r,id:e,orderDetailsData:null})})},Me=r(19),He=r.n(Me),Qe=r(22),Je=r(114),Ve="GET_INGREDIENTS_REQUEST",Ke="GET_INGREDIENTS_SUCCESS",Xe="GET_INGREDIENTS_ERROR",Ye={allIngredients:[],ingredientsRequest:!1,ingredientsFailed:!1},$e={constructorIngredients:[],isBun:null},Ze={currentIngredient:{}},et={orderNumber:"....",orderRequest:!1,orderFailed:!1},tt="LOGIN_REQUEST",rt="LOGIN_SUCCESS",nt="LOGIN_FAIL",at="LOGOUT_REQUEST",ct="LOGOUT_SUCCESS",st="LOGOUT_FAIL",ot="REGISTER_REQUEST",it="REGISTER_SUCCESS",ut="REGISTER_FAIL",lt="FORGOT_PASSWORD_REQUEST",dt="FORGOT_PASSWORD_SUCCESS",jt="FORGOT_PASSWORD_FAIL",pt="RESET_PASSWORD_REQUEST",ft="RESET_PASSWORD_SUCCESS",Ot="RESET_PASSWORD_FAIL",mt="GET_USER_REQUEST",bt="GET_USER_SUCCESS",_t="GET_USER_FAIL",ht="UPDATE_USER_REQUEST",xt="UPDATE_USER_SUCCESS",gt="UPDATE_USER_FAIL",vt="REFRESH_TOKEN_REQUEST",yt="REFRESH_TOKEN_SUCCESS",Nt="REFRESH_TOKEN_ERROR",St={user:{email:"",name:""},accessToken:"",refreshToken:"",registerRequest:!1,registerSuccess:!1,registerError:!1,loginRequest:!1,loginSuccess:!1,loginError:!1,forgotPasswordRequest:!1,forgotPasswordSuccess:!1,forgotPasswordError:!1,resetPasswordRequest:!1,resetPasswordSuccess:!1,resetPasswordError:!1,logoutRequest:!1,logoutSuccess:!1,logoutError:!1,refreshTokenRequest:!1,refreshTokenSuccess:!1,refreshTokenError:!1,getUserInfoRequest:!1,getUserInfoSuccess:!1,getUserInfoError:!1,updateUserInfoRequest:!1,updateUserInfoSuccess:!1,updateUserInfoError:!1},Et="WS_CONNECTION_SUCCESS",Ct="WS_CONNECTION_ERROR",It="WS_CONNECTION_CLOSED",Tt="WS_GET_ORDERS",kt={wsConnected:!1,ordersData:null,error:""},Rt={ordersData:null,ordersDataRequest:!1,ordersDataError:!1},Dt="GET_ORDERS_DATA_REQUEST",wt="GET_ORDERS_DATA_SUCCESS",Ut="GET_ORDERS_DATA_ERROR",At={userOrdersData:null,userOrdersDataRequest:!1,userOrdersDataError:!1},Pt=" SET_ORDER_DETAILS",Wt="CLEAR_ORDER_DETAILS",qt={orderDetails:null},Bt=Object(Qe.b)({allIngredients:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ye,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ve:return Object(H.a)(Object(H.a)({},e),{},{ingredientsRequest:!0});case Ke:return Object(H.a)(Object(H.a)({},e),{},{ingredientsFailed:!1,allIngredients:t.allIngredients,ingredientsRequest:!1});case Xe:return Object(H.a)(Object(H.a)({},e),{},{ingredientsFailed:!0,ingredientsRequest:!1});default:return e}},constructorIngredients:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$e,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case G:return Object(H.a)(Object(H.a)({},e),{},{isBun:t.ingredientItem});case L:return Object(H.a)(Object(H.a)({},e),{},{constructorIngredients:[].concat(Object(W.a)(e.constructorIngredients),[t.ingredientItem])});case F:return Object(H.a)(Object(H.a)({},e),{},{constructorIngredients:e.constructorIngredients.filter((function(e,r){return r!==t.ingredientItemIndex}))});case z:var r=t.payload,n=r.dragIndex,a=r.hoverIndex,c=Object(W.a)(e.constructorIngredients);return c[n]=c.splice(a,1,c[n])[0],Object(H.a)(Object(H.a)({},e),{},{constructorIngredients:c});case M:return Object(H.a)(Object(H.a)({},e),{},{constructorIngredients:$e.constructorIngredients,isBun:$e.isBun});default:return Object(H.a)({},e)}},viewedIngredient:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ze,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case k:return Object(H.a)(Object(H.a)({},e),{},{currentIngredient:t.payload});case R:return Object(H.a)(Object(H.a)({},e),{},{currentIngredient:Ze.currentIngredient});default:return e}},order:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:et,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case re:return Object(H.a)(Object(H.a)({},e),{},{orderNumber:et.orderNumber,orderRequest:!0,orderFailed:!1});case ne:return Object(H.a)(Object(H.a)({},e),{},{orderNumber:t.orderNumber,orderRequest:!1});case ae:return Object(H.a)(Object(H.a)({},e),{},{orderFailed:!0,orderRequest:!1});default:return e}},auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:St,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ot:return Object(H.a)(Object(H.a)({},e),{},{registerRequest:!0,registerSuccess:!1,registerError:!1});case it:return Object(H.a)(Object(H.a)({},e),{},{registerSuccess:!0,accessToken:t.accessToken,refreshToken:t.refreshToken,user:t.user});case ut:return Object(H.a)(Object(H.a)({},e),{},{registerRequest:!1,registerSuccess:!1,registerError:!0});case tt:return Object(H.a)(Object(H.a)({},e),{},{loginRequest:!0,loginSuccess:!1,loginError:!1});case rt:return Object(H.a)(Object(H.a)({},e),{},{loginRequest:!1,loginSuccess:!0,logoutSuccess:!1,accessToken:t.accessToken,refreshToken:t.refreshToken,user:t.user});case nt:return Object(H.a)(Object(H.a)({},e),{},{loginRequest:!1,loginSuccess:!1,loginError:!0});case lt:return Object(H.a)(Object(H.a)({},e),{},{forgotPasswordRequest:!0,forgotPasswordSuccess:!1,forgotPasswordError:!1});case dt:return Object(H.a)(Object(H.a)({},e),{},{forgotPasswordRequest:!1,forgotPasswordSuccess:!0});case jt:return Object(H.a)(Object(H.a)({},e),{},{forgotPasswordRequest:!1,forgotPasswordSuccess:!1,forgotPasswordError:!0});case pt:return Object(H.a)(Object(H.a)({},e),{},{resetPasswordRequest:!0,resetPasswordSuccess:!1,resetPasswordError:!1});case ft:return Object(H.a)(Object(H.a)({},e),{},{resetPasswordRequest:!1,resetPasswordSuccess:!0});case Ot:return Object(H.a)(Object(H.a)({},e),{},{resetPasswordRequest:!1,resetPasswordSuccess:!1,resetPasswordError:!0});case at:return Object(H.a)(Object(H.a)({},e),{},{logoutRequest:!0,logoutSuccess:!1,logoutError:!1});case ct:return Object(H.a)(Object(H.a)({},e),{},{logoutRequest:!1,logoutSuccess:!0,loginSuccess:!1,accessToken:St.accessToken,refreshToken:St.refreshToken,user:St.user});case st:return Object(H.a)(Object(H.a)({},e),{},{logoutRequest:!1,logoutSuccess:!1,logoutError:!0});case vt:return Object(H.a)(Object(H.a)({},e),{},{refreshTokenRequest:!0,refreshTokenSuccess:!1,refreshTokenError:!1});case yt:return Object(H.a)(Object(H.a)({},e),{},{refreshTokenRequest:!1,refreshTokenSuccess:!0,accessToken:t.accessToken,refreshToken:t.refreshToken});case Nt:return Object(H.a)(Object(H.a)({},e),{},{refreshTokenRequest:!1,refreshTokenSuccess:!1,refreshTokenError:!0});case mt:return Object(H.a)(Object(H.a)({},e),{},{getUserInfoRequest:!0,getUserInfoSuccess:!1,getUserInfoError:!1});case bt:return Object(H.a)(Object(H.a)({},e),{},{getUserInfoRequest:!1,getUserInfoSuccess:!0,user:t.user});case _t:return Object(H.a)(Object(H.a)({},e),{},{getUserInfoRequest:!1,getUserInfoSuccess:!1,getUserInfoError:!0});case ht:return Object(H.a)(Object(H.a)({},e),{},{updateUserInfoRequest:!0,updateUserInfoSuccess:!1,updateUserInfoError:!1});case xt:return Object(H.a)(Object(H.a)({},e),{},{updateUserInfoRequest:!1,updateUserInfoSuccess:!0,user:t.user});case gt:return Object(H.a)(Object(H.a)({},e),{},{updateUserInfoRequest:!1,updateUserInfoSuccess:!1,updateUserInfoError:!0});default:return e}},webSocket:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:kt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Et:return Object(H.a)(Object(H.a)({},e),{},{wsConnected:!0,error:null});case Ct:return Object(H.a)(Object(H.a)({},e),{},{wsConnected:!1,error:t.payload});case It:return Object(H.a)(Object(H.a)({},e),{},{wsConnected:!1,error:null});case Tt:return Object(H.a)(Object(H.a)({},e),{},{ordersData:t.payload,error:null});default:return e}},ordersData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Rt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case De:return Object(H.a)(Object(H.a)({},e),{},{ordersDataRequest:!0,ordersDataError:!1});case we:return Object(H.a)(Object(H.a)({},e),{},{ordersData:t.ordersData,ordersDataRequest:!1});case Ue:return Object(H.a)(Object(H.a)({},e),{},{ordersDataRequest:!1,ordersDataError:!0});default:return e}},userOrdersData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:At,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Dt:return Object(H.a)(Object(H.a)({},e),{},{userOrdersDataRequest:!0,userOrdersDataError:!1});case wt:return Object(H.a)(Object(H.a)({},e),{},{userOrdersData:t.userOrdersData,userOrdersDataRequest:!1});case Ut:return Object(H.a)(Object(H.a)({},e),{},{userOrdersDataRequest:!1,userOrdersDataError:!0});default:return e}},orderDetails:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Pt:return Object(H.a)(Object(H.a)({},e),{},{orderDetails:t.order});case Wt:return Object(H.a)(Object(H.a)({},e),{},{orderDetails:null});default:return e}}}),Gt={wsStart:"WS_CONNECTION_START",wsSendMessage:"WS_SEND_MESSAGE",onOpen:Et,onClose:It,onError:Ct,wsGetOrders:Tt},Lt=(window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Qe.c)(Object(Qe.a)(Je.a),Object(Qe.a)((function(e){var t=null;return function(r){return function(n){var a=e.dispatch,c=n.type,s=n.payload,o=Gt.wsStart,i=Gt.wsSendMessage,u=Gt.onOpen,l=Gt.onClose,d=Gt.onError,j=Gt.wsGetOrders;if(c===o&&(t=new WebSocket(n.wsUrl)),t&&(t.onopen=function(e){a({type:u,payload:e})},t.onerror=function(e){a({type:d,payload:e})},t.onmessage=function(e){var t=e.data,r=JSON.parse(t);a({type:j,payload:r})},t.onclose=function(e){a({type:l,payload:e})},c===i)){var p=Object(H.a)(Object(H.a)({},s),{},{token:Se()});t.send(JSON.stringify(p))}r(n)}}}))),Ft=Object(Qe.d)(Bt,Lt),zt=r(31),Mt=r.n(zt),Ht=function(e){var t=e.order,r=e.onCardOrderClick,n=Object(w.h)(),a=T((function(e){return e.allIngredients})).allIngredients,c=function(e){var t=Date.parse(e);return new Date(t).toLocaleString()}(t.createdAt),s=0;return Object(j.jsx)("li",{className:"".concat(Mt.a.cardOrder," p-6"),children:Object(j.jsxs)(i.b,{className:Mt.a.link,to:{pathname:"".concat(n.pathname,"/").concat(t._id),state:{backgroundOrders:n}},onClick:function(){r(t)},children:[Object(j.jsxs)("div",{className:Mt.a.idWithDateContainer,children:[Object(j.jsx)("p",{className:"text text_type_digits-default",children:"#".concat(t.number)}),Object(j.jsx)("p",{className:"text text_type_main-default text_color_inactive",children:c})]}),Object(j.jsx)("p",{className:"text text_type_main-medium mt-6",children:t.name}),Object(j.jsxs)("div",{className:"".concat(Mt.a.ingredientsWithPriceContainer," mt-6"),children:[Object(j.jsx)("div",{className:"".concat(Mt.a.ingredientsContainer," mr-6"),children:t.ingredients.map((function(e,r){var n=a.find((function(t){return e===t._id}));return n&&(s+=+n.price),Object(j.jsx)("img",{className:Mt.a.img,src:n?n.image:"",style:{zIndex:Math.abs(r-100)},alt:n?n.name:" "},"".concat(t._id," + ").concat(r))}))}),Object(j.jsx)(Be,{price:s,textType:"text_type_digits-default",typeIcon:"primary"})]})]})})},Qt=r(115),Jt=r.n(Qt),Vt=function(e){var t=e.onCardOrderClick,r=e.ordersData;return Object(j.jsx)(j.Fragment,{children:r&&Object(j.jsx)("ul",{className:Jt.a.orders,children:r.orders.map((function(e){return Object(j.jsx)(Ht,{order:e,onCardOrderClick:t},e._id)}))})})},Kt=function(e){var t=e.onCardOrderClick,r=I(),n=T((function(e){return e.webSocket})),c=n.ordersData,s=n.wsConnected;return a.a.useEffect((function(){return r({type:Gt.wsStart,wsUrl:"wss://norma.nomoreparties.space/orders/all"}),function(){r({type:Gt.onClose})}}),[r]),Object(j.jsxs)("main",{className:He.a.orderFeed,children:[Object(j.jsx)("h1",{className:"".concat(He.a.heading," text text_type_main-large mt-10"),children:"\u041b\u0435\u043d\u0442\u0430 \u0437\u0430\u043a\u0430\u0437\u043e\u0432"}),c&&s?Object(j.jsxs)("div",{className:"".concat(He.a.container," mt-5"),children:[Object(j.jsx)(Vt,{onCardOrderClick:t,ordersData:c}),Object(j.jsxs)("dl",{className:He.a.stats,children:[Object(j.jsxs)("div",{className:He.a.readyWithInProgressContainer,children:[Object(j.jsxs)("div",{children:[Object(j.jsx)("dt",{className:"text text_type_main-medium",children:"\u0413\u043e\u0442\u043e\u0432\u044b:"}),Object(j.jsx)("dd",{className:He.a.ordersContainer,children:Object(j.jsx)("ul",{className:"".concat(He.a.list," mt-6"),children:c.orders.map((function(e){return"done"===e.status?Object(j.jsx)("li",{className:"text text_type_digits-default text_color_success",children:e.number},e._id):null}))})})]}),Object(j.jsxs)("div",{children:[Object(j.jsx)("dt",{className:"text text_type_main-medium",children:"\u0412 \u0440\u0430\u0431\u043e\u0442\u0435:"}),Object(j.jsx)("dd",{className:He.a.ordersContainer,children:Object(j.jsx)("ul",{className:"".concat(He.a.list," mt-6"),children:c.orders.map((function(e){return"pending"===e.status?Object(j.jsx)("li",{className:"text text_type_digits-default",children:e.number},e._id):null}))})})]})]}),Object(j.jsx)("dt",{className:"text text_type_main-medium mt-15",children:"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e \u0437\u0430 \u0432\u0441\u0435 \u0432\u0440\u0435\u043c\u044f:"}),Object(j.jsx)("dd",{className:"".concat(He.a.numberOfOrders," text text_type_digits-large"),children:c.total.toLocaleString("ru-RU")}),Object(j.jsx)("dt",{className:"text text_type_main-medium mt-15",children:"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e \u0437\u0430 \u0441\u0435\u0433\u043e\u0434\u043d\u044f"}),Object(j.jsx)("dd",{className:"".concat(He.a.numberOfOrders," text text_type_digits-large"),children:c.totalToday.toLocaleString("ru-RU")})]})]}):Object(j.jsx)(j.Fragment,{})]})},Xt=r(209),Yt=r(118),$t=r(119),Zt=["children"],er=function(e){var t=e.children,r=Object($t.a)(e,Zt),n=!!Ne();return Object(j.jsx)(w.b,Object(H.a)(Object(H.a)({},r),{},{render:function(e){var r=e.location;return n?t:Object(j.jsx)(w.a,{to:{pathname:"/login",state:{from:r}}})}}))},tr=r(23),rr=r.n(tr),nr=new(function(){function e(t){var r=t.serverUrl;Object(Q.a)(this,e),this.serverUrl=void 0,this.serverUrl=r}return Object(J.a)(e,[{key:"register",value:function(e,t,r){return fetch("".concat(this.serverUrl,"/auth/register"),{method:"POST",headers:{Authorization:"",Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t,name:r})}).then($)}},{key:"login",value:function(e,t){return fetch("".concat(this.serverUrl,"/auth/login"),{method:"POST",headers:{Authorization:"",Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then($)}},{key:"forgotPassword",value:function(e){return fetch("".concat(this.serverUrl,"/password-reset"),{method:"POST",headers:{Authorization:"",Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e})}).then($)}},{key:"resetPassword",value:function(e,t){return fetch("".concat(this.serverUrl,"/password-reset/reset"),{method:"POST",headers:{Authorization:"",Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({password:e,token:t})}).then($)}},{key:"logout",value:function(e){return fetch("".concat(this.serverUrl,"/auth/logout"),{method:"POST",headers:{Authorization:"",Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({token:e})}).then($)}},{key:"refreshToken",value:function(e){return fetch("".concat(this.serverUrl,"/auth/token"),{method:"POST",headers:{Authorization:"",Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({token:e})}).then($)}},{key:"getUserInfo",value:function(e){return fetch("".concat(this.serverUrl,"/auth/user"),{method:"GET",headers:{Authorization:"Bearer ".concat(e),Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){return e}))}},{key:"updateUserInfo",value:function(e,t,r,n){return fetch("".concat(this.serverUrl,"/auth/user"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(e),Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({name:t,email:r,password:n})}).then((function(e){return e.json()})).then((function(e){return e}))}}]),e}())({serverUrl:Y}),ar=function(e){return function(t){return t({type:at}),nr.logout(e).then((function(e){e.success&&(console.log(e.message),t({type:ct}))})).catch((function(e){console.log(e),t({type:st})}))}},cr=function(e,t){return function(r){return r({type:vt}),nr.refreshToken(e).then((function(e){if(e.success){var n=e.accessToken.split("Bearer ")[1],a=e.refreshToken;document.cookie="accessToken=".concat(n),document.cookie="refreshToken=".concat(a),r({type:yt,accessToken:n,refreshToken:a})}t&&r(t)})).catch((function(e){console.log(e),r({type:Nt})}))}},sr=function e(){return function(t){var r=localStorage.getItem("token");if(t({type:mt}),r)return nr.getUserInfo(r).then((function(e){if(!e.success)throw e;t({type:bt,user:e.user})})).catch((function(r){if("jwt expired"===r.message){var n=Ne();t(cr(n,(function(){return e()})))}else console.log(r);t({type:_t})}))}},or=function(){var e=I(),t=Object(n.useState)(""),r=Object(o.a)(t,2),a=r[0],c=r[1],s=Object(w.h)(),l=T((function(e){return e.auth})).forgotPasswordSuccess,d=!!Ne();return l?Object(j.jsx)(w.a,{to:{pathname:"/reset-password",state:{from:s}}}):Object(j.jsxs)(j.Fragment,{children:[d?Object(j.jsx)(w.a,{to:"/"}):Object(j.jsx)("div",{className:rr.a.loginWrapper,children:Object(j.jsxs)("div",{className:rr.a.loginContent,children:[Object(j.jsx)("p",{className:"text text_type_main-medium ".concat(rr.a.formTitle),children:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043f\u0430\u0440\u043e\u043b\u044f"}),Object(j.jsxs)("form",{onSubmit:function(t){t.preventDefault(),e(function(e){return function(t){return t({type:lt}),nr.forgotPassword(e).then((function(e){e.success&&(console.log(e.message),t({type:dt}))})).catch((function(e){console.log(e),t({type:jt})}))}}(a)),c("")},className:rr.a.form,children:[Object(j.jsx)("div",{className:rr.a.inputWrapper,children:Object(j.jsx)(u.Input,{value:a,name:"email",type:"email",placeholder:"\u0423\u043a\u0430\u0436\u0438\u0442\u0435 e-mail",onChange:function(e){return c(e.target.value)},size:"default"})}),Object(j.jsx)("div",{className:rr.a.submitWrapper,children:Object(j.jsx)(u.Button,{type:"primary",size:"medium",children:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c"})})]}),Object(j.jsx)("div",{children:Object(j.jsxs)("p",{className:"text text_type_main-default ".concat(rr.a.paragraph),children:["\u0412\u0441\u043f\u043e\u043c\u043d\u0438\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c? ",Object(j.jsx)(i.b,{className:rr.a.link,to:"/login",children:"\u0412\u043e\u0439\u0442\u0438"})]})})]})}),";"]})},ir=r(21),ur=r.n(ir),lr=function(){var e=Object(n.useState)(""),t=Object(o.a)(e,2),r=t[0],a=t[1],c=Object(n.useState)(""),s=Object(o.a)(c,2),l=s[0],d=s[1],p=Object(w.g)(),f=Object(w.h)(),O=!!Ne(),m=I();return T((function(e){return e.auth})).resetPasswordSuccess?Object(j.jsx)(w.a,{to:"/login"}):(f.state||p.push("/"),Object(j.jsx)(j.Fragment,{children:O?Object(j.jsx)(w.a,{to:"/"}):Object(j.jsx)("div",{className:ur.a.loginWrapper,children:Object(j.jsxs)("div",{className:ur.a.loginContent,children:[Object(j.jsx)("p",{className:"text text_type_main-medium ".concat(ur.a.formTitle),children:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043f\u0430\u0440\u043e\u043b\u044f"}),Object(j.jsxs)("form",{onSubmit:function(e){e.preventDefault(),m(function(e,t){return function(r){return r({type:pt}),nr.resetPassword(e,t).then((function(e){e.success&&(console.log(e.message),r({type:ft}))})).catch((function(e){console.log(e),r({type:Ot})}))}}(r,l)),a(""),d("")},className:ur.a.form,children:[Object(j.jsx)("div",{className:ur.a.inputWrapper,children:Object(j.jsx)(u.PasswordInput,{name:"password",value:r,onChange:function(e){return a(e.target.value)}})}),Object(j.jsx)("div",{className:ur.a.inputWrapper,children:Object(j.jsx)(u.Input,{type:"text",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u0434 \u0438\u0437 \u043f\u0438\u0441\u044c\u043c\u0430",onChange:function(e){return d(e.target.value)},name:"code",size:"default",value:l})}),Object(j.jsx)("div",{className:ur.a.buttonWrapper,children:Object(j.jsx)(u.Button,{type:"primary",size:"medium",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})})]}),Object(j.jsx)("div",{children:Object(j.jsxs)("p",{className:"text text_type_main-default ".concat(ur.a.paragraph),children:["\u0412\u0441\u043f\u043e\u043c\u043d\u0438\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c? ",Object(j.jsx)(i.b,{className:ur.a.link,to:"/login",children:"\u0412\u043e\u0439\u0442\u0438"})]})})]})})}))},dr=r(25),jr=r.n(dr),pr=function(){var e=I(),t=Object(n.useState)(""),r=Object(o.a)(t,2),a=r[0],c=r[1],s=Object(n.useState)(""),l=Object(o.a)(s,2),d=l[0],p=l[1];if(T((function(e){return e.auth})).loginSuccess)return Object(j.jsx)(w.a,{to:"/"});var f=!!Ne();return Object(j.jsx)(j.Fragment,{children:f?Object(j.jsx)(w.a,{to:"/"}):Object(j.jsxs)("form",{className:jr.a.form,onSubmit:function(t){t.preventDefault(),e(function(e,t){return function(r){return r({type:tt}),nr.login(e,t).then((function(e){e.success&&(r({type:rt,user:e.user,accessToken:e.accessToken.split("Bearer ")[1],refreshToken:e.refreshToken}),localStorage.setItem("token",e.accessToken.split("Bearer ")[1]),ye(e))})).catch((function(e){console.log(e),r({type:nt})}))}}(a,d)),c(""),p("")},children:[Object(j.jsx)("h2",{className:"text text_type_main-medium mb-6",children:"\u0412\u0445\u043e\u0434"}),Object(j.jsxs)("div",{className:jr.a.formContainer,children:[Object(j.jsx)(u.Input,{value:a,name:"email",type:"email",placeholder:"E-mail",onChange:function(e){return c(e.target.value)},size:"default"}),Object(j.jsx)(u.PasswordInput,{value:d,name:"password",size:"default",onChange:function(e){return p(e.target.value)}}),Object(j.jsx)("div",{className:jr.a.submitWrapper,children:Object(j.jsx)(u.Button,{type:"primary",size:"medium",children:"\u0412\u0445\u043e\u0434"})})]}),Object(j.jsxs)("p",{className:["text text_type_main-default mt-20",jr.a.text].join(" "),children:["\u0412\u044b \u2014 \u043d\u043e\u0432\u044b\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c?",Object(j.jsx)(i.b,{className:jr.a.link,to:"/register",children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"})]}),Object(j.jsxs)("p",{className:["text text_type_main-default mt-4",jr.a.text].join(" "),children:["\u0417\u0430\u0431\u044b\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c?",Object(j.jsx)(i.b,{className:jr.a.link,to:"/forgot-password",children:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c"})]})]})})},fr=r(56),Or=r(47),mr=r.n(Or),br=r(26),_r=r.n(br),hr=function(e){var t=e.handleLogout,r=e.menuText;return Object(j.jsxs)("div",{className:"".concat(_r.a.linkContainer," mt-30 mr-15"),children:[Object(j.jsx)(i.c,{to:"/profile",exact:!0,className:"".concat(_r.a.link," text text_type_main-medium text_color_inactive"),activeClassName:_r.a.linkActive,children:"\u041f\u0440\u043e\u0444\u0438\u043b\u044c"}),Object(j.jsx)(i.c,{to:"/profile/orders",exact:!0,className:"".concat(_r.a.link," text text_type_main-medium text_color_inactive"),activeClassName:_r.a.linkActive,children:"\u0418\u0441\u0442\u043e\u0440\u0438\u044f \u0437\u0430\u043a\u0430\u0437\u043e\u0432"}),Object(j.jsx)("button",{className:"".concat(_r.a.button," text text_type_main-medium text_color_inactive"),onClick:t,children:"\u0412\u044b\u0445\u043e\u0434"}),Object(j.jsx)("p",{className:"".concat(_r.a.paragraph," text text_type_main-default text_color_inactive mt-20"),children:r})]})},xr=function(){var e=I(),t=Object(w.g)(),r=a.a.useState({name:"",email:"",password:""}),c=Object(o.a)(r,2),s=c[0],i=c[1],l=a.a.useState(!1),d=Object(o.a)(l,2),p=d[0],f=d[1],O=function(e){var t=e.target,r=t.name;i((function(e){return Object(H.a)(Object(H.a)({},e),{},Object(fr.a)({},r,t.value))})),f(!0)},m=T((function(e){return e.auth})).logoutSuccess,b=T((function(e){return e.auth})).user;Object(n.useEffect)((function(){var t=Se();console.error(t),e(sr())}),[e]),Object(n.useEffect)((function(){i((function(e){return Object(H.a)(Object(H.a)({},e),{},{name:b.name,email:b.email})}))}),[b]),Object(n.useEffect)((function(){m&&t.push("/login")}),[m,t]);var _=a.a.useRef(null),h=a.a.useRef(null),x=a.a.useRef(null),g=function(e){e.current.classList.remove("input__textfield-disabled"),e.current.disabled=!1,e.current.focus()};return Object(j.jsxs)("section",{className:mr.a.section,children:[Object(j.jsx)(hr,{handleLogout:function(){var t=Ne();e(ar(t)),ye({accessToken:"Bearer ",refreshToken:""}),i({name:"",email:"",password:""})},menuText:"\u0412 \u044d\u0442\u043e\u043c \u0440\u0430\u0437\u0434\u0435\u043b\u0435 \u0432\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0441\u0432\u043e\u0438 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435"}),Object(j.jsx)("form",{className:"".concat(mr.a.form," mt-30"),children:Object(j.jsxs)("div",{className:mr.a.formContainer,children:[Object(j.jsx)(u.Input,{value:s.name,name:"name",type:"text",placeholder:"\u0418\u043c\u044f",onChange:O,size:"default",icon:"EditIcon",disabled:!0,ref:_,onIconClick:function(){g(_)}}),Object(j.jsx)(u.Input,{value:s.email,name:"email",type:"email",placeholder:"\u041b\u043e\u0433\u0438\u043d",onChange:O,size:"default",icon:"EditIcon",disabled:!0,ref:h,onIconClick:function(){g(h)}}),Object(j.jsx)(u.Input,{value:s.password,name:"password",type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",onChange:O,size:"default",icon:"EditIcon",disabled:!0,ref:x,onIconClick:function(){g(x)}}),p&&Object(j.jsxs)("div",{className:mr.a.buttonContainer,children:[Object(j.jsx)(u.Button,{type:"secondary",size:"medium",children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),Object(j.jsx)(u.Button,{type:"primary",size:"medium",onClick:function(t){t.preventDefault();var r=Se();e(function(e,t,r,n){return function(a){return a({type:ht}),nr.updateUserInfo(e,t,r,n).then((function(e){if(!e.success)throw e;a({type:xt,user:{name:t,email:r,password:n}})})).catch((function(e){if("jwt expired"===e.message){var t=Ne();a(cr(t,(function(){return sr()})))}else console.log(e);a({type:gt})}))}}(r,s.name,s.email,s.password)),f(!1)},children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]})]})})]})},gr=r(116),vr=r.n(gr),yr=function(){return Object(j.jsxs)("div",{className:"".concat(vr.a.container," mt-30"),children:[Object(j.jsx)("h2",{className:"text text_type_main-large",children:"\u0414\u0435\u0442\u0430\u043b\u0438 \u0438\u043d\u0433\u0440\u0435\u0434\u0438\u0435\u043d\u0442\u0430"}),Object(j.jsx)(Re,{})]})},Nr=r(63),Sr=r.n(Nr),Er=function(e){var t=e.onCardOrderClick,r=I(),n=Object(w.g)(),c=T((function(e){return e.auth})).logoutSuccess,s=T((function(e){return e.auth})).user,i=T((function(e){return e.webSocket})).ordersData,u=a.a.useState({name:"",email:"",password:""}),l=Object(o.a)(u,2)[1];return a.a.useEffect((function(){var e=localStorage.getItem("token");return r(sr()),r({type:Gt.wsStart,wsUrl:"".concat("wss://norma.nomoreparties.space/orders","?token=").concat(e)}),function(){r({type:Gt.onClose})}}),[r]),a.a.useEffect((function(){l((function(e){return Object(H.a)(Object(H.a)({},e),{},{name:s.name,email:s.email})}))}),[s]),a.a.useEffect((function(){c&&n.push("/login")}),[c,n]),Object(j.jsxs)("section",{className:Sr.a.section,children:[Object(j.jsx)(hr,{handleLogout:function(){var e=Ne();r(ar(e)),ye({accessToken:"Bearer ",refreshToken:""}),l({name:"",email:"",password:""})},menuText:"\u0412 \u044d\u0442\u043e\u043c \u0440\u0430\u0437\u0434\u0435\u043b\u0435 \u0432\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0441\u0432\u043e\u044e \u0438\u0441\u0442\u043e\u0440\u0438\u044e \u0437\u0430\u043a\u0430\u0437\u043e\u0432"}),Object(j.jsx)("div",{className:"".concat(Sr.a.container," mt-10"),children:i&&Object(j.jsx)("ul",{className:Sr.a.orders,children:i.orders.map((function(e){return Object(j.jsx)(Ht,{order:e,onCardOrderClick:t},e._id)}))})})]})},Cr=r(37),Ir=r.n(Cr),Tr=function(){var e=I(),t=Object(w.g)(),r=Object(n.useState)(""),a=Object(o.a)(r,2),c=a[0],s=a[1],l=Object(n.useState)(""),d=Object(o.a)(l,2),p=d[0],f=d[1],O=Object(n.useState)(""),m=Object(o.a)(O,2),b=m[0],_=m[1],h=!!Ne(),x=T((function(e){return e.auth})).registerSuccess;return Object(n.useEffect)((function(){x&&t.push("/login")}),[x,t]),Object(j.jsx)(j.Fragment,{children:h?Object(j.jsx)(w.a,{to:"/"}):Object(j.jsxs)("form",{className:Ir.a.form,noValidate:!0,onSubmit:function(t){t.preventDefault(),e(function(e,t,r){return function(n){return n({type:ot}),nr.register(e,t,r).then((function(e){e.success&&(n({type:it,user:e.user,accessToken:e.accessToken.split("Bearer ")[1],refreshToken:e.refreshToken}),ye(e))})).catch((function(e){console.log(e),n({type:ut})}))}}(p,b,c)),f(""),_(""),s("")},children:[Object(j.jsx)("h2",{className:"text text_type_main-medium mb-6",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(j.jsxs)("div",{className:Ir.a.formContainer,children:[Object(j.jsx)(u.Input,{type:"text",placeholder:"\u0418\u043c\u044f",onChange:function(e){return s(e.target.value)},name:"name",size:"default",value:c}),Object(j.jsx)(u.Input,{type:"email",placeholder:"E-mail",onChange:function(e){return f(e.target.value)},name:"email",size:"default",value:p}),Object(j.jsx)(u.PasswordInput,{name:"password",value:b,onChange:function(e){return _(e.target.value)}}),Object(j.jsx)("div",{className:Ir.a.submitWrapper,children:Object(j.jsx)(u.Button,{type:"primary",size:"medium",children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"})})]}),Object(j.jsx)("div",{children:Object(j.jsxs)("p",{className:"text text_type_main-default mt-20 ".concat(Ir.a.paragraph),children:["\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b? ",Object(j.jsx)(i.b,{className:Ir.a.link,to:"/login",children:"\u0412\u043e\u0439\u0442\u0438"})]})})]})})},kr=r(117),Rr=r.n(kr),Dr=function(){var e=Object(w.i)().id,t=T((function(e){return e.userOrdersData})).userOrdersData,r=I();return a.a.useEffect((function(){var e=localStorage.getItem("token");r(sr()),r(function(e){return function(t){return t({type:Dt}),te.getUserOrdersData(e).then((function(e){t({type:wt,userOrdersData:e})})).catch((function(e){console.log(e),t({type:Ut})}))}}(e))}),[r]),Object(j.jsx)("div",{className:Rr.a.orderInfo,children:t?Object(j.jsx)(Ge,{ordersData:t,id:e,orderDetailsData:null}):Object(j.jsx)(j.Fragment,{})})};var wr=function(){var e=Object(n.useState)(!1),t=Object(o.a)(e,2),r=t[0],c=t[1],s=Object(C.b)();Object(n.useEffect)((function(){s((function(e){e({type:Ve}),Z().then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430 ".concat(e.status))})).then((function(t){t&&t.success?e({type:Ke,allIngredients:t.data}):e({type:Xe})})).catch((function(t){e({type:Xe})}))}))}),[s]);var i=Object(w.g)(),u=Object(w.h)(),l="PUSH"===i.action||"REPLACE"===i.action,d=l&&u.state&&u.state.background,p=l&&u.state&&u.state.backgroundOrders,f=T((function(e){return e.orderDetails})).orderDetails,O=function(e){s(function(e){return{type:Pt,order:e}}(e)),c(!0)},m=a.a.useCallback((function(e){c(!1),e&&i.goBack()}),[i]);return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(v,{}),Object(j.jsxs)(w.d,{location:d||u||p,children:[Object(j.jsx)(w.b,{path:"/",exact:!0,children:Object(j.jsx)("main",{className:Ie.a.main,children:Object(j.jsxs)(Xt.a,{backend:Yt.a,children:[Object(j.jsx)(P,{onCardClick:function(){c(!0)}}),Object(j.jsx)(Ee,{history:i})]})})}),Object(j.jsx)(w.b,{path:"/login",exact:!0,children:Object(j.jsx)(pr,{})}),Object(j.jsx)(w.b,{path:"/register",exact:!0,children:Object(j.jsx)(Tr,{})}),Object(j.jsx)(w.b,{path:"/forgot-password",exact:!0,children:Object(j.jsx)(or,{})}),Object(j.jsx)(w.b,{path:"/reset-password",exact:!0,children:Object(j.jsx)(lr,{})}),Object(j.jsx)(er,{path:"/profile",exact:!0,children:Object(j.jsx)(xr,{})}),Object(j.jsx)(w.b,{path:"/feed",exact:!0,children:Object(j.jsx)(Kt,{onCardOrderClick:O})}),Object(j.jsx)(w.b,{path:"/feed/:id",exact:!0,children:Object(j.jsx)(ze,{})}),Object(j.jsx)(er,{path:"/profile/orders",exact:!0,children:Object(j.jsx)(Er,{onCardOrderClick:O})}),Object(j.jsx)(w.b,{path:"/profile/orders/:id",exact:!0,children:Object(j.jsx)(Dr,{})}),Object(j.jsx)(w.b,{path:"/ingredients/:id",exact:!0,children:Object(j.jsx)(yr,{})})]}),d&&Object(j.jsx)(ve,{open:r,onClose:m,title:"\u0414\u0435\u0442\u0430\u043b\u0438 \u0438\u043d\u0433\u0440\u0435\u0434\u0438\u0435\u043d\u0442\u0430",isGoBack:!0,children:Object(j.jsx)(Re,{})}),p&&Object(j.jsx)(ve,{open:r,onClose:m,title:"",isGoBack:!0,children:Object(j.jsx)(Ge,{ordersData:null,orderDetailsData:f,id:""})})]})};s.a.render(Object(j.jsx)(a.a.StrictMode,{children:Object(j.jsx)(C.a,{store:Ft,children:Object(j.jsx)(i.a,{children:Object(j.jsx)(wr,{})})})}),document.getElementById("root"))},21:function(e,t,r){e.exports={loginWrapper:"reset-password_loginWrapper__1BMtj",loginContent:"reset-password_loginContent__2n5wJ",formTitle:"reset-password_formTitle__2fJLD",form:"reset-password_form__2c9jy",inputWrapper:"reset-password_inputWrapper__3c58K",buttonWrapper:"reset-password_buttonWrapper__1jRtc",paragraph:"reset-password_paragraph__2bDpe",link:"reset-password_link__Q_BeI"}},23:function(e,t,r){e.exports={loginWrapper:"forgot-password_loginWrapper__2-nqb",loginContent:"forgot-password_loginContent__3zB4U",formTitle:"forgot-password_formTitle__3XCLr",form:"forgot-password_form__1R-uN",inputWrapper:"forgot-password_inputWrapper__2jOuF",submitWrapper:"forgot-password_submitWrapper__5xf3l",paragraph:"forgot-password_paragraph__20-8M",link:"forgot-password_link__2faUD"}},25:function(e,t,r){e.exports={form:"login_form__18WSd",formContainer:"login_formContainer__1Fp-E",submitWrapper:"login_submitWrapper__19jHo",text:"login_text__2Xv_W",link:"login_link__1_K0k"}},26:function(e,t,r){e.exports={linkContainer:"ProfileNavigationMenu_linkContainer__2g3uJ",link:"ProfileNavigationMenu_link__3bEz2",linkActive:"ProfileNavigationMenu_linkActive__1IocQ",button:"ProfileNavigationMenu_button__3jttB",paragraph:"ProfileNavigationMenu_paragraph__3yXMC"}},30:function(e,t,r){e.exports={card:"Card_card__2vDVy",counter:"Card_counter__pMgfG",price:"Card_price__24HFz",priceNum:"Card_priceNum__2oucV",name:"Card_name__mE20S"}},31:function(e,t,r){e.exports={cardOrder:"CardOrder_cardOrder__1D3O1",idWithDateContainer:"CardOrder_idWithDateContainer__2YHKg",ingredientsWithPriceContainer:"CardOrder_ingredientsWithPriceContainer__39Qqj",img:"CardOrder_img__3iV4C",link:"CardOrder_link__27FxW",price:"CardOrder_price__R9PjS"}},34:function(e,t,r){e.exports={section:"BurgerIngredients_section__3QJWm",cards:"BurgerIngredients_cards__otbMP",scroll:"BurgerIngredients_scroll__3Qo5l"}},35:function(e,t,r){e.exports={ul:"BurgerConstructorItems_ul__c2fl1",item:"BurgerConstructorItems_item__1esmR",itemWrapper:"BurgerConstructorItems_itemWrapper__337yb",scroll:"BurgerConstructorItems_scroll__1gh2P"}},36:function(e,t,r){e.exports={orderWrapper:"OrderDetails_orderWrapper__2guS_",order:"OrderDetails_order__1imyX",orderNum:"OrderDetails_orderNum__2nrDL OrderDetails_order__1imyX"}},37:function(e,t,r){e.exports={form:"register_form__3jzE-",formContainer:"register_formContainer__SqqZv",submitWrapper:"register_submitWrapper__2YmRA",paragraph:"register_paragraph__3d-yh",link:"register_link__1WKiv"}},46:function(e,t,r){e.exports={modalHeader:"Modal_modalHeader__1yxhH",modalHeaderWrapper:"Modal_modalHeaderWrapper__3ByN4",headerText:"Modal_headerText__3yTsi",button:"Modal_button__v-eXO",overlay:"Modal_overlay__2btyM"}},47:function(e,t,r){e.exports={section:"profile_section__3V6WD",form:"profile_form__3RJ5b",formContainer:"profile_formContainer__2I6xV",buttonContainer:"profile_buttonContainer__2qAtn"}},60:function(e,t,r){e.exports={link:"NavigationLink_link__2gCc3",linkText:"NavigationLink_linkText__1MCq3",linkTextActive:"NavigationLink_linkTextActive__2lIFm"}},62:function(e,t,r){e.exports={items:"BurgerConstructor_items__si86D",totalWrapper:"BurgerConstructor_totalWrapper__1sKpw",totalPrice:"BurgerConstructor_totalPrice__tN5Gh"}},63:function(e,t,r){e.exports={section:"profile-orders_section__k1xf0",container:"profile-orders_container__aICY-",orders:"profile-orders_orders__2aTxN"}},83:function(e,t,r){e.exports={header:"AppHeader_header__3k3xj",headerContainer:"AppHeader_headerContainer__CzLrW"}}},[[203,1,2]]]);
//# sourceMappingURL=main.e718956b.chunk.js.map